{
  "profile_api_documentation": {
    "title": "Profile Management API - User & Admin",
    "version": "2.0.0",
    "base_url": "{{BASE_URL}}/api",
    "authentication": {
      "type": "Bearer Token",
      "header": "Authorization: Bearer {{TOKEN}}",
      "note": "All endpoints require authentication with Sanctum token"
    },
    "user_roles": {
      "user": {
        "description": "Regular wedding users with packages",
        "access": "Can manage their own profile",
        "middleware": "auth:sanctum,role:user"
      },
      "admin": {
        "description": "System administrators",
        "access": "Can manage their own admin profile",
        "middleware": "auth:sanctum,role:admin"
      }
    },
    "endpoints": {
      "user_profile": {
        "description": "Profile management endpoints for regular users",
        "middleware": "auth:sanctum,role:user",
        "endpoints": {
          "get_user_profile": {
            "method": "GET",
            "url": "/profile",
            "route_name": "profile.show",
            "description": "Mendapatkan data lengkap profile user yang sedang login",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer {{USER_TOKEN}}"
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Profile data berhasil diambil",
                "data": {
                  "id": 1,
                  "name": "John Doe",
                  "email": "john@example.com",
                  "phone": "08123456789",
                  "profile_photo_url": "https://domain.com/storage/profile-photos/photo.jpg",
                  "kode_pemesanan": "#1234567890",
                  "package_info": {
                    "id": 2,
                    "name": "Gold Package",
                    "jenis_paket": "gold",
                    "price": 150000,
                    "currency": "IDR",
                    "payment_status": "paid",
                    "is_active": true
                  },
                  "domain_info": {
                    "domain": "john-wedding",
                    "is_active": true,
                    "expires_at": "2025-12-01T10:30:00.000000Z",
                    "days_until_expiry": 92,
                    "payment_confirmed_at": "2025-09-01T10:30:00.000000Z"
                  },
                  "created_at": "2025-08-01T10:30:00.000000Z",
                  "updated_at": "2025-09-01T14:30:00.000000Z"
                }
              }
            },
            "response_error": {
              "status": 500,
              "body": {
                "success": false,
                "message": "Terjadi kesalahan saat mengambil data profile",
                "error": "Error message (if debug mode enabled)"
              }
            }
          },
          "update_user_profile": {
            "method": "PUT",
            "url": "/profile",
            "route_name": "profile.update",
            "description": "Memperbarui data profile user (nama, email, nomor HP)",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer {{USER_TOKEN}}"
            },
            "request_body": {
              "name": "John Doe Updated",
              "email": "john.updated@example.com",
              "phone": "08987654321"
            },
            "validation_rules": {
              "name": {
                "required": true,
                "type": "string",
                "min_length": 2,
                "max_length": 255,
                "pattern": "Only letters and spaces allowed"
              },
              "email": {
                "required": true,
                "type": "email",
                "max_length": 255,
                "unique": "Must be unique across users (excluding current user)"
              },
              "phone": {
                "required": true,
                "type": "string",
                "min_length": 10,
                "max_length": 15,
                "pattern": "Indonesian phone format: +62, 62, or 0 followed by 9-13 digits"
              }
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Profile berhasil diperbarui",
                "data": {
                  "id": 1,
                  "name": "John Doe Updated",
                  "email": "john.updated@example.com",
                  "phone": "08987654321",
                  "profile_photo_url": "https://domain.com/storage/profile-photos/photo.jpg",
                  "package_info": {
                    "id": 2,
                    "name": "Gold Package",
                    "jenis_paket": "gold",
                    "price": 150000,
                    "currency": "IDR",
                    "payment_status": "paid",
                    "is_active": true
                  },
                  "updated_at": "2025-09-01T14:35:00.000000Z"
                }
              }
            },
            "response_validation_error": {
              "status": 422,
              "body": {
                "message": "The given data was invalid.",
                "errors": {
                  "name": ["Nama wajib diisi.", "Nama minimal 2 karakter."],
                  "email": ["Format email tidak valid.", "Email sudah digunakan oleh pengguna lain."],
                  "phone": ["Nomor HP wajib diisi.", "Format nomor HP tidak valid."]
                }
              }
            }
          },
          "upload_user_photo": {
            "method": "POST",
            "url": "/profile/photo",
            "route_name": "profile.upload-photo",
            "description": "Upload foto profile user",
            "headers": {
              "Content-Type": "multipart/form-data",
              "Authorization": "Bearer {{USER_TOKEN}}"
            },
            "request_body": {
              "profile_photo": "FILE (image file)"
            },
            "validation_rules": {
              "profile_photo": {
                "required": true,
                "type": "image",
                "allowed_formats": ["jpeg", "png", "jpg", "webp"],
                "max_size": "2MB",
                "dimensions": {
                  "min_width": 100,
                  "min_height": 100,
                  "max_width": 2000,
                  "max_height": 2000
                }
              }
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Foto profile berhasil diperbarui",
                "data": {
                  "profile_photo_url": "https://domain.com/storage/profile-photos/new-photo.jpg",
                  "updated_at": "2025-09-01T14:40:00.000000Z"
                }
              }
            },
            "response_validation_error": {
              "status": 422,
              "body": {
                "message": "The given data was invalid.",
                "errors": {
                  "profile_photo": [
                    "Foto profil wajib dipilih.",
                    "Foto profil harus berformat JPEG, PNG, JPG, atau WEBP.",
                    "Ukuran foto profil maksimal 2MB."
                  ]
                }
              }
            }
          },
          "delete_user_photo": {
            "method": "DELETE",
            "url": "/profile/photo",
            "route_name": "profile.delete-photo",
            "description": "Menghapus foto profile user",
            "headers": {
              "Authorization": "Bearer {{USER_TOKEN}}"
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Foto profile berhasil dihapus",
                "data": {
                  "profile_photo_url": null,
                  "updated_at": "2025-09-01T14:45:00.000000Z"
                }
              }
            },
            "response_not_found": {
              "status": 404,
              "body": {
                "success": false,
                "message": "Tidak ada foto profile untuk dihapus"
              }
            }
          },
          "change_user_password": {
            "method": "POST",
            "url": "/profile/change-password",
            "route_name": "profile.change-password",
            "description": "Mengubah password user",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer {{USER_TOKEN}}"
            },
            "request_body": {
              "current_password": "current_password_here",
              "new_password": "NewStrongPassword123!",
              "new_password_confirmation": "NewStrongPassword123!"
            },
            "validation_rules": {
              "current_password": {
                "required": true,
                "type": "string",
                "validation": "Must match user's current password"
              },
              "new_password": {
                "required": true,
                "type": "string",
                "min_length": 8,
                "requirements": [
                  "At least one lowercase letter",
                  "At least one uppercase letter",
                  "At least one number",
                  "At least one special character"
                ],
                "confirmed": "Must match new_password_confirmation"
              },
              "new_password_confirmation": {
                "required": true,
                "type": "string",
                "validation": "Must match new_password"
              }
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Kata sandi berhasil diperbarui",
                "data": {
                  "updated_at": "2025-09-01T14:50:00.000000Z"
                }
              }
            },
            "response_validation_error": {
              "status": 422,
              "body": {
                "message": "The given data was invalid.",
                "errors": {
                  "current_password": ["Kata sandi saat ini tidak benar."],
                  "new_password": [
                    "Kata sandi baru minimal 8 karakter.",
                    "Konfirmasi kata sandi baru tidak cocok."
                  ]
                }
              }
            }
          }
        }
      },
      "admin_profile": {
        "description": "Profile management endpoints for admin users",
        "middleware": "auth:sanctum,role:admin",
        "endpoints": {
          "get_admin_profile": {
            "method": "GET",
            "url": "/profile",
            "route_name": "admin.profile.show",
            "description": "Mendapatkan data lengkap profile admin yang sedang login",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer {{ADMIN_TOKEN}}"
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Profile data berhasil diambil",
                "data": {
                  "id": 1,
                  "name": "Admin User",
                  "email": "admin@example.com",
                  "phone": "08123456789",
                  "profile_photo_url": "https://domain.com/storage/profile-photos/admin-photo.jpg",
                  "kode_pemesanan": null,
                  "package_info": null,
                  "domain_info": null,
                  "created_at": "2025-01-01T10:30:00.000000Z",
                  "updated_at": "2025-09-01T14:30:00.000000Z"
                }
              }
            },
            "response_error": {
              "status": 500,
              "body": {
                "success": false,
                "message": "Terjadi kesalahan saat mengambil data profile",
                "error": "Error message (if debug mode enabled)"
              }
            }
          },
          "update_admin_profile": {
            "method": "PUT",
            "url": "/profile",
            "route_name": "admin.profile.update",
            "description": "Memperbarui data profile admin (nama, email, nomor HP)",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer {{ADMIN_TOKEN}}"
            },
            "request_body": {
              "name": "Admin User Updated",
              "email": "admin.updated@example.com",
              "phone": "08987654321"
            },
            "validation_rules": {
              "name": {
                "required": true,
                "type": "string",
                "min_length": 2,
                "max_length": 255,
                "pattern": "Only letters and spaces allowed"
              },
              "email": {
                "required": true,
                "type": "email",
                "max_length": 255,
                "unique": "Must be unique across users (excluding current admin)"
              },
              "phone": {
                "required": true,
                "type": "string",
                "min_length": 10,
                "max_length": 15,
                "pattern": "Indonesian phone format: +62, 62, or 0 followed by 9-13 digits"
              }
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Profile berhasil diperbarui",
                "data": {
                  "id": 1,
                  "name": "Admin User Updated",
                  "email": "admin.updated@example.com",
                  "phone": "08987654321",
                  "profile_photo_url": "https://domain.com/storage/profile-photos/admin-photo.jpg",
                  "package_info": null,
                  "updated_at": "2025-09-01T14:35:00.000000Z"
                }
              }
            },
            "response_validation_error": {
              "status": 422,
              "body": {
                "message": "The given data was invalid.",
                "errors": {
                  "name": ["Nama wajib diisi.", "Nama minimal 2 karakter."],
                  "email": ["Format email tidak valid.", "Email sudah digunakan oleh pengguna lain."],
                  "phone": ["Nomor HP wajib diisi.", "Format nomor HP tidak valid."]
                }
              }
            }
          },
          "upload_admin_photo": {
            "method": "POST",
            "url": "/profile/photo",
            "route_name": "admin.profile.upload-photo",
            "description": "Upload foto profile admin",
            "headers": {
              "Content-Type": "multipart/form-data",
              "Authorization": "Bearer {{ADMIN_TOKEN}}"
            },
            "request_body": {
              "profile_photo": "FILE (image file)"
            },
            "validation_rules": {
              "profile_photo": {
                "required": true,
                "type": "image",
                "allowed_formats": ["jpeg", "png", "jpg", "webp"],
                "max_size": "2MB",
                "dimensions": {
                  "min_width": 100,
                  "min_height": 100,
                  "max_width": 2000,
                  "max_height": 2000
                }
              }
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Foto profile berhasil diperbarui",
                "data": {
                  "profile_photo_url": "https://domain.com/storage/profile-photos/new-admin-photo.jpg",
                  "updated_at": "2025-09-01T14:40:00.000000Z"
                }
              }
            },
            "response_validation_error": {
              "status": 422,
              "body": {
                "message": "The given data was invalid.",
                "errors": {
                  "profile_photo": [
                    "Foto profil wajib dipilih.",
                    "Foto profil harus berformat JPEG, PNG, JPG, atau WEBP.",
                    "Ukuran foto profil maksimal 2MB."
                  ]
                }
              }
            }
          },
          "delete_admin_photo": {
            "method": "DELETE",
            "url": "/profile/photo",
            "route_name": "admin.profile.delete-photo",
            "description": "Menghapus foto profile admin",
            "headers": {
              "Authorization": "Bearer {{ADMIN_TOKEN}}"
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Foto profile berhasil dihapus",
                "data": {
                  "profile_photo_url": null,
                  "updated_at": "2025-09-01T14:45:00.000000Z"
                }
              }
            },
            "response_not_found": {
              "status": 404,
              "body": {
                "success": false,
                "message": "Tidak ada foto profile untuk dihapus"
              }
            }
          },
          "change_admin_password": {
            "method": "POST",
            "url": "/profile/change-password",
            "route_name": "admin.profile.change-password",
            "description": "Mengubah password admin",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer {{ADMIN_TOKEN}}"
            },
            "request_body": {
              "current_password": "current_admin_password",
              "new_password": "NewAdminPassword123!",
              "new_password_confirmation": "NewAdminPassword123!"
            },
            "validation_rules": {
              "current_password": {
                "required": true,
                "type": "string",
                "validation": "Must match admin's current password"
              },
              "new_password": {
                "required": true,
                "type": "string",
                "min_length": 8,
                "requirements": [
                  "At least one lowercase letter",
                  "At least one uppercase letter",
                  "At least one number",
                  "At least one special character"
                ],
                "confirmed": "Must match new_password_confirmation"
              },
              "new_password_confirmation": {
                "required": true,
                "type": "string",
                "validation": "Must match new_password"
              }
            },
            "response_success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Kata sandi berhasil diperbarui",
                "data": {
                  "updated_at": "2025-09-01T14:50:00.000000Z"
                }
              }
            },
            "response_validation_error": {
              "status": 422,
              "body": {
                "message": "The given data was invalid.",
                "errors": {
                  "current_password": ["Kata sandi saat ini tidak benar."],
                  "new_password": [
                    "Kata sandi baru minimal 8 karakter.",
                    "Konfirmasi kata sandi baru tidak cocok."
                  ]
                }
              }
            }
          }
        }
      }
    },
    "route_summary": {
      "user_routes": {
        "middleware": "auth:sanctum,role:user",
        "base_path": "/api/profile",
        "routes": [
          {
            "method": "GET",
            "path": "/",
            "name": "profile.show",
            "description": "Get user profile"
          },
          {
            "method": "PUT",
            "path": "/",
            "name": "profile.update",
            "description": "Update user profile"
          },
          {
            "method": "POST",
            "path": "/photo",
            "name": "profile.upload-photo",
            "description": "Upload user photo"
          },
          {
            "method": "DELETE",
            "path": "/photo",
            "name": "profile.delete-photo",
            "description": "Delete user photo"
          },
          {
            "method": "POST",
            "path": "/change-password",
            "name": "profile.change-password",
            "description": "Change user password"
          }
        ]
      },
      "admin_routes": {
        "middleware": "auth:sanctum,role:admin",
        "base_path": "/api/profile",
        "routes": [
          {
            "method": "GET",
            "path": "/",
            "name": "admin.profile.show",
            "description": "Get admin profile"
          },
          {
            "method": "PUT",
            "path": "/",
            "name": "admin.profile.update",
            "description": "Update admin profile"
          },
          {
            "method": "POST",
            "path": "/photo",
            "name": "admin.profile.upload-photo",
            "description": "Upload admin photo"
          },
          {
            "method": "DELETE",
            "path": "/photo",
            "name": "admin.profile.delete-photo",
            "description": "Delete admin photo"
          },
          {
            "method": "POST",
            "path": "/change-password",
            "name": "admin.profile.change-password",
            "description": "Change admin password"
          }
        ]
      }
    },
    "common_responses": {
      "unauthorized": {
        "status": 401,
        "body": {
          "message": "Unauthenticated."
        }
      },
      "forbidden": {
        "status": 403,
        "body": {
          "message": "This action is unauthorized."
        }
      },
      "server_error": {
        "status": 500,
        "body": {
          "success": false,
          "message": "Terjadi kesalahan server",
          "error": "Error details (if debug enabled)"
        }
      }
    },
    "frontend_implementation_guide": {
      "setup": {
        "base_url": "Set your API base URL",
        "token_storage": "Store Sanctum token in localStorage or secure storage",
        "headers": "Always include Authorization header with Bearer token",
        "role_detection": "Check user role to determine which profile endpoints to use"
      },
      "form_handling": {
        "profile_form": {
          "fields": ["name", "email", "phone"],
          "validation": "Use client-side validation matching server rules",
          "submission": "PUT request to /profile endpoint",
          "differences": {
            "user": "Includes package and domain information in response",
            "admin": "No package/domain info, admin-specific data only"
          }
        },
        "photo_upload": {
          "input_type": "file",
          "accepted_formats": ".jpeg,.png,.jpg,.webp",
          "max_size": "2MB",
          "preview": "Show image preview before upload",
          "submission": "POST multipart/form-data to /profile/photo",
          "same_for_both_roles": true
        },
        "password_change": {
          "fields": ["current_password", "new_password", "new_password_confirmation"],
          "security": "Use password input types, validate strength",
          "submission": "POST to /profile/change-password",
          "same_for_both_roles": true
        }
      },
      "error_handling": {
        "validation_errors": "Display field-specific errors from errors object",
        "server_errors": "Show general error message to user",
        "network_errors": "Handle offline/network issues gracefully",
        "role_specific": "Handle different response structures for user vs admin"
      },
      "state_management": {
        "profile_data": "Store and update profile state after successful operations",
        "loading_states": "Show loading indicators during API calls",
        "success_feedback": "Show success messages after operations",
        "role_aware": "Manage different data structures for user and admin profiles"
      }
    },
    "security_notes": {
      "authentication": "All endpoints require valid Sanctum token",
      "authorization": "Both user and admin roles can access their respective profile endpoints",
      "file_upload": "Images are validated for type, size, and dimensions",
      "password_change": "Current password verification required for both roles",
      "data_protection": "Sensitive data properly hidden in responses",
      "role_separation": "Users and admins can only access their own profile data"
    },
    "testing_examples": {
      "postman_collection": {
        "environment_variables": {
          "BASE_URL": "http://localhost:8000/api",
          "USER_TOKEN": "user_sanctum_token_here",
          "ADMIN_TOKEN": "admin_sanctum_token_here"
        },
        "test_scenarios": {
          "user_tests": [
            "Get user profile data (with package info)",
            "Update user profile with valid data",
            "Update user profile with invalid data (validation test)",
            "Upload valid user profile photo",
            "Upload invalid user profile photo (validation test)",
            "Delete user profile photo",
            "Change user password with correct current password",
            "Change user password with incorrect current password"
          ],
          "admin_tests": [
            "Get admin profile data (without package info)",
            "Update admin profile with valid data",
            "Update admin profile with invalid data (validation test)",
            "Upload valid admin profile photo",
            "Upload invalid admin profile photo (validation test)",
            "Delete admin profile photo",
            "Change admin password with correct current password",
            "Change admin password with incorrect current password"
          ],
          "security_tests": [
            "Test user token cannot access admin-specific features",
            "Test admin token cannot access user-specific features",
            "Test unauthorized access (no token)",
            "Test invalid token access"
          ]
        }
      }
    },
    "implementation_notes": {
      "shared_controller": "Both user and admin use the same ProfileController",
      "middleware_differences": "Different route names and middleware groups",
      "response_differences": {
        "user": "Includes package_info and domain_info",
        "admin": "Returns null for package_info and domain_info"
      },
      "validation_same": "Same validation rules apply to both user and admin",
      "file_handling_same": "Same photo upload/delete logic for both roles"
    }
  }
}